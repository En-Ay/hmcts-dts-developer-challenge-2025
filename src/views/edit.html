{% extends "layout.html" %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/textarea/macro.njk" import govukTextarea %}
{% from "govuk/components/select/macro.njk" import govukSelect %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/back-link/macro.njk" import govukBackLink %}

{% block content %}
<div class="govuk-grid-row">
  
  <div class="govuk-grid-column-two-thirds">
    
    <div class="govuk-error-summary" id="error-summary" aria-labelledby="error-summary-title" role="alert" tabindex="-1" style="display: none;">
      <h2 class="govuk-error-summary__title" id="error-summary-title">There is a problem</h2>
      <div class="govuk-error-summary__body">
        <ul class="govuk-list govuk-error-summary__list">
          <li id="summary-title-error" style="display: none;"><a href="#title">Enter a task title</a></li>
          <li id="summary-date-error" style="display: none;"><a href="#due_date">Enter a due date and time</a></li>
        </ul>
      </div>
    </div>

    {{ govukBackLink({ text: "Back", href: "/" }) }}
    
    <h1 class="govuk-heading-xl">Edit Task</h1>

    <input type="hidden" id="task-id" value="{{ taskId }}">

    <form id="edit-task-form" novalidate>
      <div class="govuk-form-group" id="title-group">
        <label class="govuk-label govuk-label--l" for="title">Task Title</label>
        <p id="title-error" class="govuk-error-message" style="display: none;">
          <span class="govuk-visually-hidden">Error:</span> Enter a task title
        </p>
        <input class="govuk-input" id="title" name="title" type="text">
      </div>

      {{ govukTextarea({
        name: "description", id: "description",
        label: { text: "Description", classes: "govuk-label--m" }
      }) }}

      {{ govukSelect({
        id: "status", name: "status",
        label: { text: "Status" },
        items: [
          { value: "PENDING", text: "Pending" },
          { value: "IN_PROGRESS", text: "In Progress" },
          { value: "COMPLETED", text: "Completed" }
        ]
      }) }}

      <div class="govuk-form-group" id="due-date-group">
        <label class="govuk-label" for="due_date">Due Date</label>
        <p id="due-date-error" class="govuk-error-message" style="display: none;">
          <span class="govuk-visually-hidden">Error:</span> Enter a due date and time
        </p>
        <input class="govuk-input govuk-input--width-20" id="due_date" name="due_date" type="datetime-local">
      </div>

      <div class="govuk-button-group">
        {{ govukButton({ text: "Save Changes" }) }}
        <button type="button" class="govuk-button govuk-button--warning" id="delete-task-btn">Delete task</button>
      </div>
    </form>
  </div>

  <div class="govuk-grid-column-one-third">
    <aside class="app-related-items" role="complementary">
      <h2 class="govuk-heading-m" id="subsection-title">Audit History</h2>
      <div id="history-container" style="border-left: 2px solid #b1b4b6; padding-left: 15px;">
        <p class="govuk-body-s text-grey">Loading history...</p>
      </div>
    </aside>
  </div>

</div>
{% endblock %}